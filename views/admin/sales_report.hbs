<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>admin</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">
    <script src="https://kit.fontawesome.com/3aba129f51.js" crossorigin="anonymous"></script>

    <!-- dataTable-->
    <script src="https://code.jquery.com/jquery-3.6.1.js"
        integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>

    {{!-- <link rel="stylesheet" type="text/css" href='https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css' > --}}
    <link rel="stylesheet" type="text/css" href='/admin/DataTables/datatables.min.css'> <!--
        Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto:wght@500;700&display=swap"
        rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="/admin/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="/admin/lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="/admin/stylesheets/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="/admin/stylesheets/style.css" rel="stylesheet">
    {{!-- datas --}}

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />


</head>

<body>
    <div class="container-fluid position-relative d-flex p-0">



        <div class="sidebar pe-4 pb-3">
            {{>sidebar}}

        </div>


        <div class="content">

            {{>adminheaders}}


            <!-- Recent Sales Start -->
            <div class="container-fluid pt-4 px-4 ">
                <div class="bg-secondary text-center rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-4">
                        <h6 class="mb-0">Sales Report</h6>

                    </div>
                    <div class="container">
                <div class="row m-3">
                    <div class="col-md-2">
                        <form action="/admin/select-by-date" method="get">
                            <div>
                                <label for="select from">Select From</label>
                                <input type="date" name="fdate" value="{{report.fdata}}">
                            </div>
                    </div>
                    <div class="col-md-2 text-center">
                        <label for="select from">Select To</label>
                        <input type="date" name="todate" value="{{report.todata}}">
                         <button type="submit" hidden></button >
                        </form>
                    </div>
                    <div class="col-md-3" style="margin-left: 50px;">
                        <form action="/admin/select-by-month" method="get">

                            <label for="select from">Select month</label>
                            <input type="month" name="month">
                            <button type="submit" hidden></button>

                        </form>
                    </div>
                    <div class="col-md-2">
                        <form action="/admin/select-by-year" method="get">
                            <label for="select from">Year</label>
                            <input type="text" name="year">

                            <button type="submit" hidden></button>

                        </form>
                    </div>
                </div>
            </div>
                  
                    {{#if report}}



                    <div class="table-responsive">

                        <table class="table display nowrap" id="sale">
                            <thead>
                                <tr class="text-dark">

                                    <th scope="col">No.</th>
                                    <th scope="col">Invoice</th>
                                    <th scope="col">Product</th>
                                    <th scope="col">Brand</th>
                                    <th scope="col">Quantity</th>
                                    <th scope="col">Total</th>
                                    {{!-- <th scope="col">Price</th>
                                    <th scope="col">Offer Price</th> --}}



                                    {{!-- <th scope="col">Amount</th>
                                    <th scope="col">Status</th>
                                    <th scope="col">Action</th> --}}
                                </tr>
                            </thead>
                            <tbody>
                                {{#each report}}
                                <tr>
                                    <td>{{inc @index}}</td>
                                    <td>{{this._id}}</td>
                                    <td>{{this.product.name}}</td>
                                    <td>{{this.product.brand}}</td>
                                    <td>{{this.quantity}}</td>

                                    <td class="tot"> {{this.total}}</td>


                                </tr>

                                {{/each}}

                            </tbody>
                            <tfoot>
                                <th scope="col">Grand Total</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th scope="col" id="grandtotal"></th>
                            </tfoot>
                           
                        </table>
                    </div>
                    {{else}}
                    <div class="table-responsive">

                        <table class="table display nowrap" id="sale">
                            <thead>
                                <tr class="text-dark text-center" >

                                    <th style="text-align:justify; st"  >No.</th>
                                    <th >Date</th>
                                    <th >Quantity</th>
                                    <th >Total</th>
                                    {{!-- <th scope="col">Quantity</th>
                                    <th scope="col">Total</th> --}}
                                    {{!-- <th scope="col">Price</th>
                                    <th scope="col">Offer Price</th> --}}



                                    {{!-- <th scope="col">Amount</th>
                                    <th scope="col">Status</th>
                                    <th scope="col">Action</th> --}}
                                </tr>
                            </thead>
                            <tbody>
                                {{#each data}}
                                <tr>
                                    <td>{{inc @index}}</td>
                                    <td>{{this._id}}</td>
                                    <td>{{this.quantity}}</td>
                                    <td class="tot">{{this.total}}</td>
                                    {{!-- <td>{{this.product.brand}}</td>
                                    <td>{{this.quantity}}</td>

                                    <td>{{this.total}}</td> --}}


                                </tr>

                                {{/each}}

                            </tbody>
                            <tfoot>
                                <tfoot>
                                <th scope="col">Grand Total</th>
                                <th></th>
                                <th></th>
                                 <th scope="col" id="grandtotal"></th>
                            </tfoot>
                            </tfoot>
                        </table>
                    </div>

                    {{/if}}
                </div>
            </div>
            <!-- Recent Sales End -->



            <!-- Footer End -->
        </div>



    </div>
    <script>
        $(document).ready(function () {
            $('#sale').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    'csv', 'excel', 'pdf',
                ]
            });
        });
    </script>
    <script>
        

        var grandtotal=0;
        let tot=document.querySelectorAll('.tot')
        
        tot.forEach((element)=>{
            let value=parseInt (element.innerHTML)
            grandtotal=grandtotal+value

        })
        
        document.getElementById('grandtotal').innerHTML=grandtotal
      
    </script>




    <!-- JavaScript Libraries -->
    {{!--
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> --}}
    <script type="text/javascript" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/admin/lib/chart/chart.min.js"></script>
    <script src="/admin/lib/easing/easing.min.js"></script>
    <script src="/admin/lib/waypoints/waypoints.min.js"></script>
    <script src="/admin/lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="/admin/lib/tempusdominus/js/moment.min.js"></script>
    <script src="/admin/lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="/admin/lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

    <!-- Template Javascript -->
    <script src="/admin/javascripts/main.js"></script>
</body>

</html>